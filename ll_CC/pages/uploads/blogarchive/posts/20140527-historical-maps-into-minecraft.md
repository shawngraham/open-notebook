title: Historical Maps into Minecraft
link: http://electricarchaeology.ca/2014/05/27/historical-maps-into-minecraft/
author: fhg1711
description: 
post_id: 2019
created: 2014/05/27 10:55:26
created_gmt: 2014/05/27 15:55:26
comment_status: open
post_name: historical-maps-into-minecraft
status: publish
post_type: post

# Historical Maps into Minecraft

[caption id="attachment_2021" align="alignleft" width="300"]![dowslakemap1847](http://electricarchaeologist.files.wordpress.com/2014/05/dowslakemap1847.jpg?w=300) Dow's Lake area, settlement by 1847 Map Source: Bruce Elliott, Nepean, The City Beyond, page 23, posted on http://www.bytown.net/dowslake.htm[/caption] The folks over at the [New York Public Library published](http://www.nypl.org/blog/2014/05/05/historical-maps-minecraft) an [excellent & comprehensive tutorial for digitizing historical maps, and then importing them into Minecraft.](https://github.com/NYPL/historical-minecraft/) First: thank you! Unfortunately, for me, it's not working. I document here what I've been doing and ideally someone far more clever than me will figure out what needs to happen... The first parts of the tutorial - working with QGIS & Inkscape - go very well (although there might be a problem with colours, but more on that anon). Let's look at the python script for combining the elevation map (generated from QGIS) with the blocks map (generated from Inkscape). Oh, you also need to install imagemagick, which you then run from the command line, to convert SVG to TIF. 

> "The [script for generating the worlds](https://github.com/NYPL/historical-minecraft/blob/master/fort-washington/generate_map.py) uses [PIL](http://www.pythonware.com/products/pil/) to load the TIFF bitmaps into memory, and [pymclevel](https://github.com/mcedit/pymclevel) to generate a Minecraft worlds, one block at a time. It's run successfully on both Mac OS X and Linux."

[caption id="attachment_2022" align="alignleft" width="300"]![After digitizing, looks like this.](http://electricarchaeologist.files.wordpress.com/2014/05/hogs-features.jpg?w=300) After digitizing, looks like this.[/caption] I've tried both Mac and Linux, with python installed, and PIL, and pymclevel. No joy (for the same reasons as for Windows, detailed below). Like most things computational, there are dependencies that we only uncover quite by accident... Anyway, when you've got python installed on Windows, you can just type the python file name at the command prompt and you're off. So I download pymclevel, unzip it, open a command prompt in that folder (shift + right click, 'open command prompt here'), and type 'setup.py'. Error message. Turns out, I need _setuptools_. Which I obtain from: <https://pypi.python.org/pypi/setuptools#windows-7-or-graphical-install> Download, install. Works. Ok, back to the pymclevel folder, setup.py, and new error message. Looks like I need something called 'cython'. <http://cython.org/#download> I download, unzip, go to that folder, setup.py. Problem. Some file called 'vcvarsall.bat' is needed. Solution? Turns out I need to donwload Microsoft Visual Studio 10. Then, I needed to create an environment variable called 'vs90comntools', which I did by typing this at the command prompt: 

> set VS90COMNTOOLS=C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\Tools\

Wunderbar. I go back to the pymclevel folder, I run setup.py again, and hooray! It installs. I had PIL installed from a previous foray into things pythonesque, so at least I didn't have to fight with that again. I copy the generate_map.py script into notepad++, change the file names within it (so that it finds my own elevation.tif and features.tif files, which are called hogs-elevation.tif and hogs-features.tif; the area I'm looking at is the Hogsback Falls section of the Rideau. In the script, just change 'fort-washington' to 'hogs' or whatever your files are called). In my folder, at the command prompt, I type generate_map.py and get a whole bunch of error messages: various 'yaml' files can't be found. Did I mention [PyYaml ](http://pyyaml.org/)has to be installed? Fortunately, it has a windows installer.  Oh, and by the way - PyWin is also needed; I got that error message at one point (something obscure about win32api), and downloading/installing from here solved it: [embed]http://sourceforge.net/projects/pywin32/files/pywin32/[/embed] Ok, so where were we? Right, missing yaml files, like 'minecraft.yaml' and 'classic.yaml', and 'indev.yaml' and 'pocket.yaml'. These files were there in the original repository, but for whatever, they didn't install into the pymclevel that now lives in the Python directory. So I went to the pymclevel repo on github, copied-and-pasted the code into new documents in notepad++, saved them as thus: c:\Python27\Lib\site-packages\pymclevel-0.1-py2.7-win32.egg\pymclevel\minecraft.yaml Phew. Back to where I was working on my maps, and have my generate_map.py, which I duly enter and.... error. can't find 'tree import Tree, treeObjs'.  Googling around to solve this is a fool's errand: 'tree' is such a common word, concept in programming that I just can't figure out what's going on here. So I turned that line off with a # in the code. Run it again.... and it seems to work (but is this the key glitch that kills all that follows?). (update: as Jonathan Goodwin points out, 'tree.py' is there, in the NYPL repo [embed]https://twitter.com/joncgoodwin/status/471321026094465024[/embed] ...so I uncommented out the line in generate_map.py, saved tree.py in the same directory, and ran the script again. Everything that follows still happens. So perhaps there's something screwed-up with my map itself.) The script tells me I need to tell it whether I'm creating a creative mode map or a survival mode: so for creative mode: c:>generate_map.py map for survival: c:>generate_map.py game And it chugs along. All is good with the world. Then: error message. KeyError: 255 in line 241, block_id, block_data, depth = block_id_lookup[block_id]. This is the bit of code that tells the script how to map minecraft blocks to the colour scheme I used in Inkcraft to paint the information from the map into my features.tif. Thing is, I never used RGB R value of 255. Where's it getting this from? I go back over my drawing, inspecting each element, trying to figure it out. All seems good with the drawing. So I just add this line to the code in the table: block_id_lookup = { [..existing code...] 255 : (m.Water.ID, 0, 1), } And run it again. Now it's 254. And then 253. Then 249. 246. 244. 241. Now 238. And which point, I say piss on this, and I provide you with my [features tif ](https://dl.dropboxusercontent.com/u/37716296/hogsback/hogs-features.tif)and [elevation tif](https://dl.dropboxusercontent.com/u/37716296/hogsback/hogs-elevation.tif) and if you can please tell me what I'm doing wrong, I'd be ever so appreciative (and here's the [svg with the drawing layers, for good measure](https://dl.dropboxusercontent.com/u/37716296/hogsback/traced-hogsback.svg)). ....when I first saw the tutorial from the NYPL, I figured, hey! I could use this with my students! I think not, at least, not yet. (update 2: have downloaded the [original map tifs ](https://github.com/NYPL/historical-minecraft/tree/master/fort-washington)that the NYPL folks used, and am running the script on them. So far, so good: which shows that, once all this stuff is installed, that it's my maps that are the problem. This is good to know!) Part Two: